<!doctype html>
<html>

<head>
    <title>Event Target Example</title>
    <script type="text/javascript" src="EventTarget.js"></script>
</head>

<body>
    <div id="myDiv" style="background:red;"></div>
    <script type="text/javascript">
    function handleMessage(event) {
        alert("Message received: " + event.message);
    }

    var target = new EventTarget();
    console.log(target.addHandler)

    target.addHandler("message", handleMessage);

    target.fire({
        type: "message",
        message: "Hello world!"
    });

    target.removeHandler("message", handleMessage);

    target.fire({
        type: "message",
        message: "Hello world!"
    });

    EventTarget.prototype = {
        constructor: EventTarget,
        on: function(type, callback) {
            if (typeof this.handlers[type] === 'undefined') {
                this.handlers[type] = []
            }
            this.handlers[type].push(callback)
        },
        emit: function(type, message) {
            if (!event.target) {
                event.target = this;
            }
            if (this.handlers[type] instanceof Array) {
                var handlers = this.handlers[type]
                for (var i = 0, len = handlers.length; i < len; i++) {
                    handlers[i](message)
                }
            }
        }
    }
    </script>
</body>

</html>
